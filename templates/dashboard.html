{% extends "base.html" %}

{% block content %}
<h2 style="text-align:center; margin-bottom:30px;">Dashboard</h2>

<!-- Cards de métricas -->
<div style="display:flex; justify-content:space-around; flex-wrap:wrap; gap:20px; margin-bottom:40px;">
    <div style="flex:1; min-width:200px; background:white; padding:20px; border-radius:10px; box-shadow:0 4px 15px rgba(0,0,0,0.1); text-align:center;">
        <h3>Total de Clientes</h3>
        <p style="font-size:24px; font-weight:bold;">{{ total }}</p>
    </div>
    <div style="flex:1; min-width:200px; background:white; padding:20px; border-radius:10px; box-shadow:0 4px 15px rgba(0,0,0,0.1); text-align:center;">
        <h3>Fechados</h3>
        <p style="font-size:24px; font-weight:bold;">{{ fechados }}</p>
    </div>
    <div style="flex:1; min-width:200px; background:white; padding:20px; border-radius:10px; box-shadow:0 4px 15px rgba(0,0,0,0.1); text-align:center;">
        <h3>Faturamento</h3>
        <p style="font-size:24px; font-weight:bold;">R$ {{ faturamento }}</p>
    </div>
    <div style="flex:1; min-width:200px; background:white; padding:20px; border-radius:10px; box-shadow:0 4px 15px rgba(0,0,0,0.1); text-align:center;">
        <h3>Taxa de Fechamento</h3>
        <p style="font-size:24px; font-weight:bold;">{{ taxa }}%</p>
    </div>
</div>

<!-- Filtro por mês -->
<div style="margin-bottom:30px; text-align:center;">
    <form method="get">
        <label>Filtrar por mês:</label>
        <input type="month" name="mes" value="{{ mes }}">
        <button type="submit" style="padding:5px 15px; border-radius:5px; background:#007bff; color:white; border:none; cursor:pointer;">Filtrar</button>
        <a href="/dashboard" style="padding:5px 15px; border-radius:5px; background:#6c757d; color:white; text-decoration:none;">Limpar</a>
    </form>
</div>

<!-- Gráfico de clientes fechados -->
<div style="max-width:800px; margin:0 auto; background:#fff; padding:20px; border-radius:10px; box-shadow:0 4px 15px rgba(0,0,0,0.1);">
    <h3 style="text-align:center;">Clientes Fechados por Mês</h3>
    <canvas id="graficoClientes" width="400" height="200"></canvas>
</div>

<!-- Botão para gerar o relatório -->
<div style="text-align:center; margin-top:40px;">
    <a href="/relatorio" style="padding:10px 20px; background:#28a745; color:white; text-decoration:none; border-radius:5px;">Gerar Relatório</a>
</div>

<!-- Scripts Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/chart.js') }}"></script>
<script>
    const labels = {{ labels|safe }};
    const data = {{ data|safe }};
    const ctx = document.getElementById('graficoClientes').getContext('2d');
    criarGrafico(ctx, labels, data, "bar");
</script>

{% endblock %}
